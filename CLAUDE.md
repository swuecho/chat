# Chat - Multi-LLM Chat Interface

A full-stack chat application that provides a unified interface for interacting with multiple large language models (LLMs) including OpenAI, Claude, Gemini, and Ollama.

## Project Overview

This project is a ChatGPT wrapper that extends beyond OpenAI to support multiple LLM providers. It features a Vue.js frontend with a Go backend, using PostgreSQL for data persistence.

### Key Features

- **Multi-LLM Support**: OpenAI, Claude, Gemini, and Ollama models
- **Chat Sessions**: Persistent conversation history and context management
- **User Management**: Authentication, rate limiting, and admin controls
- **File Uploads**: Support for text and multimedia files (model-dependent)
- **Snapshots**: Shareable conversation snapshots with full-text search
- **Prompt Management**: Built-in prompt templates with '/' shortcut
- **Internationalization**: Support for multiple languages

## Architecture

### Frontend (Vue.js)
- **Framework**: Vue 3 with Composition API
- **State Management**: Pinia
- **UI Library**: Naive UI
- **Routing**: Vue Router
- **Build Tool**: Rsbuild
- **Styling**: Tailwind CSS + Less

### Backend (Go)
- **Framework**: Standard Go HTTP with Gorilla Mux
- **Database**: PostgreSQL with SQLC for type-safe queries
- **Authentication**: JWT tokens
- **Rate Limiting**: Built-in rate limiting (100 calls/10min default)
- **File Upload**: Support for various file types

### Database (PostgreSQL)
- **Schema**: Located in `api/sqlc/schema.sql`
- **Queries**: Type-safe queries generated by SQLC
- **Tables**: Users, sessions, messages, models, prompts, snapshots, etc.

## Project Structure

```
chat/
├── api/                     # Go backend
│   ├── main.go             # Application entry point
│   ├── llm/                # LLM provider integrations
│   │   ├── openai/         # OpenAI integration
│   │   ├── claude/         # Claude integration
│   │   └── gemini/         # Gemini integration
│   ├── sqlc/               # Database schema and queries
│   ├── sqlc_queries/       # Generated type-safe queries
│   └── static/             # Static assets
├── web/                    # Vue.js frontend
│   ├── src/
│   │   ├── components/     # Reusable components
│   │   ├── views/          # Page components
│   │   ├── store/          # Pinia stores
│   │   ├── api/            # API client
│   │   └── utils/          # Utility functions
│   └── dist/               # Built frontend assets
├── docs/                   # Documentation
├── e2e/                    # End-to-end tests
└── data/                   # Database dumps
```

## Development Setup

### Prerequisites
- Go 1.19+
- Node.js 18+
- PostgreSQL
- (Optional) Docker

### Backend Setup
```bash
cd api
go mod tidy
go run main.go
```

### Frontend Setup
```bash
cd web
npm install
npm run dev
```

### Database Setup
1. Create a PostgreSQL database
2. Run the schema from `api/sqlc/schema.sql`
3. Configure database connection in environment variables

## Configuration

### Environment Variables
- `OPENAI_API_KEY`: OpenAI API key
- `CLAUDE_API_KEY`: Claude API key
- `GEMINI_API_KEY`: Gemini API key
- `DATABASE_URL`: PostgreSQL connection string
- `JWT_SECRET`: JWT signing secret
- `OPENAI_RATELIMIT`: Rate limit (default: 100)

## API Endpoints

### Authentication
- `POST /api/auth/login` - User login
- `POST /api/auth/register` - User registration
- `POST /api/auth/refresh` - Token refresh

### Chat
- `GET /api/chat/sessions` - Get user sessions
- `POST /api/chat/sessions` - Create new session
- `GET /api/chat/messages` - Get session messages
- `POST /api/chat/messages` - Send message
- `DELETE /api/chat/sessions/:id` - Delete session

### Models
- `GET /api/models` - List available models
- `POST /api/models` - Add new model (admin)
- `PUT /api/models/:id` - Update model (admin)

### File Upload
- `POST /api/files` - Upload file
- `GET /api/files/:id` - Get file

## Key Components

### Frontend Components
- `chat/index.vue`: Main chat interface
- `chat/components/Message/`: Message rendering
- `chat/components/Session/`: Session management
- `admin/index.vue`: Admin dashboard
- `prompt/creator.vue`: Prompt management

### Backend Handlers
- `chat_main_handler.go`: Core chat functionality
- `chat_session_handler.go`: Session management
- `chat_message_handler.go`: Message handling
- `auth_handler.go`: Authentication
- `admin_handler.go`: Admin operations

## Testing

### Backend Tests
```bash
cd api
go test ./...
```

### Frontend Tests
```bash
cd web
npm test
```

### E2E Tests
```bash
cd e2e
npm test
```

## Deployment

### Docker
```bash
docker-compose up -d
```

### Manual Deployment
1. Build frontend: `cd web && npm run build`
2. Build backend: `cd api && go build -o chat_backend`
3. Set up PostgreSQL database
4. Configure environment variables
5. Run the backend binary

## Rate Limiting

Default rate limit is 100 ChatGPT calls per 10 minutes per user. This can be configured via the `OPENAI_RATELIMIT` environment variable.

## Model Support

- **OpenAI**: GPT-3.5, GPT-4 models
- **Claude**: Claude 3 Opus, Sonnet, Haiku
- **Gemini**: Gemini Pro, Gemini Vision
- **Ollama**: Local model hosting support